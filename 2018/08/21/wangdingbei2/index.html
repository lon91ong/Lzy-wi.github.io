<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="https://github.com/Lzy-wi/Lzy-wi.github.io/blob/master/fonts//css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|logo:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="writeup,web,ctf,"><meta name="description" content="web狗感受到来自世界的恶意，已哭晕在厕所"><meta name="keywords" content="writeup,web,ctf"><meta property="og:type" content="article"><meta property="og:title" content="网鼎杯web writeup（复现）"><meta property="og:url" content="http://yoursite.com/2018/08/21/wangdingbei2/index.html"><meta property="og:site_name" content="Lzy-wi&#39;Blog"><meta property="og:description" content="web狗感受到来自世界的恶意，已哭晕在厕所"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/11.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/12.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/13.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/14.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/15.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/21.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/16.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/18.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/17.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/19.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-21/20.png"><meta property="og:updated_time" content="2018-08-21T09:45:03.610Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="网鼎杯web writeup（复现）"><meta name="twitter:description" content="web狗感受到来自世界的恶意，已哭晕在厕所"><meta name="twitter:image" content="http://yoursite.com/img/2018-08-21/11.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.4",sidebar:{position:"left",display:"hide",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://yoursite.com/2018/08/21/wangdingbei2/"><title>网鼎杯web writeup（复现） | Lzy-wi'Blog</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/Lzy-wi" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="top-scroll-bar"></div><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Lzy-wi'Blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">这个人比较懒</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/21/wangdingbei2/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Lzy-wi"><meta itemprop="description" content=""><meta itemprop="image" content="/img/touxiang/touxiang.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Lzy-wi'Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">网鼎杯web writeup（复现）</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-21T17:40:30+08:00">2018-08-21</time></span> <span class="post-comments-count"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span><a href="/2018/08/21/wangdingbei2/#comments" itemprop="discussionUrl"><span class="post-comments-count gitment-comments-count" data-xid="/2018/08/21/wangdingbei2/" itemprop="commentsCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><p><del>web狗感受到来自世界的恶意，已哭晕在厕所</del><br><a id="more"></a></p><h4 id="0x00-spider"><a href="#0x00-spider" class="headerlink" title="0x00 spider"></a>0x00 spider</h4><p>这道题参考官方给出的writeup–&gt;<a href="https://mp.weixin.qq.com/s?__biz=MzUzNTkyODI0OA==&amp;mid=2247491146&amp;idx=3&amp;sn=62911c7eede3f3207bd3badb65983d8d&amp;chksm=faff529dcd88db8b00fc09b58bd8d86ebbbd6463cba8d9319718e4ded7046fc60c76475aa943&amp;mpshare=1&amp;scene=23&amp;srcid=0820KKS4SsULFtWOy9z1xffV#rd" target="_blank" rel="noopener">传送门</a></p><h4 id="0x01-fakebook"><a href="#0x01-fakebook" class="headerlink" title="0x01 fakebook"></a>0x01 fakebook</h4><p>这道题是在比赛结束前1小时时候放出来的题目，一般这种题目都是送<del>分题</del>送命题<br><img src="/img/2018-08-21/11.png" alt="11"><br>首先拿到题目后发现只能登陆或者join，join的时候发现第四个字段blog似乎只能是网址，一般这种有约束条件又没给出则一定是被隐藏了，查看robots.txt发现果然有东西<br><img src="/img/2018-08-21/12.png" alt="12"><br>约束条件<br><img src="/img/2018-08-21/13.png" alt="13"><br>join之后发现只有username可以点，点进去后发现敏感参数<br><img src="/img/2018-08-21/14.png" alt="14"><br>测试后得到的信息：4个字段，过滤了<code>union select</code>，第四个参数进行了序列化<br><img src="/img/2018-08-21/15.png" alt="15"><br>在一段惊天地泣鬼神的注入下然鹅并没有在数据库里发现flag<br>请教大佬获得hint1：构造类。这样构造出来的类可以执行，php代码如下<br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $name = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">public</span> $age = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> $blog = <span class="string">""</span>;</span><br><span class="line">&#125;</span><br><span class="line">$a = <span class="keyword">new</span> UserInfo();</span><br><span class="line">$a-&gt;name = <span class="string">'1'</span>;</span><br><span class="line">$a-&gt;age = <span class="number">12</span>;</span><br><span class="line">$a-&gt;blog = <span class="string">'baidu.com'</span>;</span><br><span class="line"><span class="keyword">echo</span> serialize($a);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-21/21.png" alt="21"><br><img src="/img/2018-08-21/16.png" alt="16"><br>源码可以看到读取了文件<br><img src="/img/2018-08-21/18.png" alt="18"><br>请教大佬获得hint2：curl读文件。<br>源码提示了php调用curl来查询的，联想到curl可以执行读文件操作<br><img src="/img/2018-08-21/17.png" alt="17"><br>把baidu.com改成file:///var/www/html/user.php进行测试发现可以读取user.php的内容验证猜想<br><img src="/img/2018-08-21/19.png" alt="19"><br>读flag，file:///var/www/html/flag.php<br><img src="/img/2018-08-21/20.png" alt="20"></p></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/writeup/" rel="tag"><i class="fa fa-tag"></i> writeup</a><a href="/tags/web/" rel="tag"><i class="fa fa-tag"></i> web</a><a href="/tags/ctf/" rel="tag"><i class="fa fa-tag"></i> ctf</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2018/08/21/wangdingbei/" rel="next" title="网鼎杯misc writeup（复现）"><i class="fa fa-chevron-left"></i> 网鼎杯misc writeup（复现）</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/2018/09/17/CSAW/" rel="prev" title="CSAW'18 CTF writeup">CSAW'18 CTF writeup<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="gitment-container"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/img/touxiang/touxiang.jpg" alt="Lzy-wi"><p class="site-author-name" itemprop="name">Lzy-wi</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">13</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">23</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Lzy-wi" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:1721389906@qq.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#0x00-spider"><span class="nav-number">1.</span> <span class="nav-text">0x00 spider</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x01-fakebook"><span class="nav-number">2.</span> <span class="nav-text">0x01 fakebook</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright" style="text-align:center">&copy; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">Lzy-wi</span></div><div style="text-align:center"><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_uv">本站访客数:<span id="busuanzi_value_site_pv"></span></span></div><div class="theme-info"><div class="powered-by"></div> <span class="post-count">博客全站共18.0k字</span></div></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/custom/custom.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css"><script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script><style>a.gitment-editor-footer-tip{display:none}.gitment-container.gitment-footer-container{display:none}</style><script type="text/javascript">function renderGitment(){new Gitmint({id:window.location.pathname,owner:"Lzy-wi",repo:"gitment-comments",lang:navigator.language||navigator.systemLanguage||navigator.userLanguage,oauth:{client_secret:"f505e0931d7b3481f41ba49d0a62c32ed958ab03",client_id:"a6008e5dc6be6020bf5f"}}).render("gitment-container")}renderGitment()</script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/nico.model.json"},display:{position:"right",width:100,height:200},mobile:{show:!1}})</script></body></html>